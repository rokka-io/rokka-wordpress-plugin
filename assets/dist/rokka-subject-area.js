(()=>{var e,t;e=jQuery,t=window.rokkaSubjectAreaEdit={iasapi:{},hold:{},postid:"",intval:function(e){return 0|e},round:function(e){var t;return e=Math.round(e),this.hold.sizer>.6?e:"1"===(t=e.toString().slice(-1))?e-1:"9"===t?e+1:e},validateNumeric:function(e){if(!this.intval(e))return!1},init:function(t){var a=this,i=a.intval(e("#subjectarea-original-width-"+t).val()),s=a.intval(e("#subjectarea-original-height-"+t).val());a.hold.w=a.hold.ow=i,a.hold.h=a.hold.oh=s,a.hold.xy_ratio=i/s,a.hold.sizer=parseFloat(e("#subjectarea-sizer-"+t).val()),a.postid=t;var l=e("#image-subjectarea-preview-"+t),r=e("#subjectarea-"+t);this.initSubjectArea(t,l,r),this.setNumSelection(t,e("#subjectarea-sel-x-"+t)),e(".subjectarea-wrap .imgedit-help-toggle").eq(0).focus()},initSubjectArea:function(a,i,s){var l=this,r=e("#subjectarea-sel-width-"+a),n=e("#subjectarea-sel-height-"+a),h=e("#subjectarea-sel-x-"+a),o=e("#subjectarea-sel-y-"+a);l.iasapi=e(i).imgAreaSelect({parent:s,instance:!0,handles:!0,keys:!0,minWidth:3,minHeight:3,onInit:function(t){e(t).next().css("position","absolute").nextAll(".imgareaselect-outer").css("position","absolute"),s.children().mousedown((function(e){var t,i,s=!1;e.shiftKey&&(t=l.iasapi.getSelection(),i=l.getSelRatio(a),s=t&&t.width&&t.height?t.width+":"+t.height:i),l.iasapi.setOptions({aspectRatio:s})}))},onSelectChange:function(e,a){var i=t.hold.sizer;r.val(t.round(a.width/i)),n.val(t.round(a.height/i)),h.val(t.round(a.x1/i)),o.val(t.round(a.y1/i))}})},setNumSelection:function(t,a){var i,s,l,r,n=e("#subjectarea-sel-width-"+t),h=e("#subjectarea-sel-height-"+t),o=this.intval(n.val()),u=this.intval(h.val()),c=e("#subjectarea-sel-x-"+t),d=e("#subjectarea-sel-y-"+t),v=this.intval(c.val()),b=this.intval(d.val()),p=e("#image-subjectarea-preview-"+t),j=p.height(),g=p.width(),w=e("#subjectarea-info-"+t),m=this.hold.sizer,f=this.iasapi;if(w.text(""),(!1===this.validateNumeric(o)||o<3)&&(n.val(0),o=0),(!1===this.validateNumeric(u)||u<3)&&(h.val(0),u=0),(!1===this.validateNumeric(v)||v<0)&&(c.val(0),v=0),(!1===this.validateNumeric(b)||b<0)&&(d.val(0),b=0),o<3||u<3)return f.cancelSelection(),void f.update();i=Math.round(v*m),s=Math.round(b*m),l=i+Math.round(o*m),r=s+Math.round(u*m),l>g&&(i=0,l=g,n.val(Math.round(l/m)),c.val(0),w.text("Please reduce width to apply this X value.")),r>j&&(s=0,r=j,h.val(Math.round(r/m)),d.val(0),w.text("Please reduce height to apply this Y value.")),f.setSelection(i,s,l,r),f.setOptions({show:!0}),f.update()},removeSelection:function(t){var a=e("#subjectarea-sel-width-"+t),i=e("#subjectarea-sel-height-"+t),s=e("#subjectarea-sel-x-"+t),l=e("#subjectarea-sel-y-"+t),r=this.iasapi;a.val(0),i.val(0),s.val(0),l.val(0),r.cancelSelection(),r.update()}}})();
//# sourceMappingURL=rokka-subject-area.js.map
